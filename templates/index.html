<script>
async function analyze() {
    const question = document.getElementById("q").value;
    const text = document.getElementById("doc_text")?.value || "";
    const fileInput = document.getElementById("doc");
    
    const formData = new FormData();
    formData.append("question", question);
    formData.append("text", text);

    if (fileInput.files.length > 0) {
        formData.append("file", fileInput.files[0]);
    }

    const res = await fetch("/analyze", {
        method: "POST",
        body: formData
    });

    const data = await res.json();
    document.getElementById("out").innerText =
        JSON.stringify(data, null, 2);
}
</script>
